<script src="https://cdn.jsdelivr.net/npm/eosjs@15.0.3/lib/eos.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.scattercdn.com/file/scatter-cdn/js/latest/scatterjs-core.min.js"></script>
<script src="https://cdn.scattercdn.com/file/scatter-cdn/js/latest/scatterjs-plugin-eosjs.min.js"></script>
<script type="text/javascript" src="dconnect.js"></script>
<script type="text/javascript" src="saving.js"></script>
<script type="text/javascript" src="loading.js"></script>

<div class="uk-flex uk-flex-center">
  <style>
    .uk-form-label {
      color:#fff
    }
  </style>
   <article class="uk-section uk-section-small uk-padding-remove-top uk-container">
    <div class="uk-margin">
      <div>
        PRIVATE KEY<br/>
        <input type="text" onkeydown="change()" onchange="change()" id="text"/>
      </div>
      <div>
        PASSWORD<br/>
        <input type="password" onkeydown="change()" onchange="change()" id="password"/>
      </div>
      <div id="qrcode" download style="max-width:340px; width:100%; display: inline-block;"></div>
      <div>
        <pre id="code"></pre>
        <div>
            await dconnect.save(path, JSON.stringify({title:$('#title').value, category:path, hash:data.hash}));

          <button id="encrypt" onclick="dconnect.save(getCode(), );">save</button>
        </div>
     </div>
   </div>
  </article>
</div>

<script src="qrcode.js"></script>
<script src="https://bitwiseshiftleft.github.io/sjcl/sjcl.js"></script>
    <div id="output">
    </div>
    <script>
      document.getElementById("encrypt").onclick= ()=>{
        let output = 0;
        output = sjcl.encrypt(document.getElementById("password").value, document.getElementById('text').value, {iter:250000}); 
        console.log(output);
      }
      /*document.getElementById("decrypt").onclick= ()=>{
        const password = document.getElementById("password").value;
        const text = document.getElementById("text").value;
        console.log(password, text);
        document.getElementById("code").textContent = sjcl.decrypt(password, text);
      }*/
      /*qrcode = new QRCode(document.getElementById("qrcode"), {
        width : 325,
        height : 325
      });*/
      function getCode() {
        return sjcl.encrypt(document.getElementById("text").value,document.getElementById("password").value, {iter:100000});
      }
      makecode = debounce(()=>{
        const code = getCode();
        document.getElementById('code').textContent = code;
        //qrcode.makeCode(code);
      } , 250);
      change = function() {
        makecode();
      }

      document.getElementById("text")
</script>